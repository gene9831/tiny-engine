# 元数据

> DataAbility 组件概述：主要用于对外部提供统一的数据访问抽象，不提供用户交互界面
> 引用：<https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/dataability-overview-V5>

参考 DataAbility 的设计，TinyEngine 中的元数据首先要规范数据访问接口，具体的元数据都要实现这些接口。
简要数据访问接口设计如下

## 简要数据访问接口

以 AppSchema 和 PageSchema 为例，它们的数据来源都是从远程获取

```ts
interface MetaData {
  id: string
  // 查询。直接读取 state 字段
  getState(): Promise<Record<string, any>>
  // 变更
  setState(key: string, value: any): Promise<void>
}

interface Options {
  id: string
  initialState?: Record<string, any>
  source?(): Promise<Record<string, any>>
}

function createMetaData(options: Options): MetaData {
  const { id, initialState, source } = options
  let state = initialState

  return {
    id,
    async getState() {
      if (!state) {
        return (await source?.()) || {}
      }
      return {}
    },
    async setState(key, value) {}
  }
}
```
